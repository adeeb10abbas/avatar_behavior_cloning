{'_target_': 'diffusion_policy.workspace.train_diffusion_unet_image_workspace.TrainDiffusionUnetImageWorkspace', 'name': 'table_cam_only_train_diffusion_unet_hybrid', 'exp_name': 'diffusion_ddim', 'task_name': 'haptic_image_teacher_aware', 'action_dim': 18, 'horizon': 16, 'n_obs_steps': 2, 'dataset_obs_steps': 2, 'n_action_steps': 8, 'n_latency_steps': 0, 'obs_as_global_cond': True, 'past_action_visible': False, 'pred_action_steps_only': False, 'abs_action': True, 'keypoint_visible_rate': 1.0, 'image_shape': [3, 480, 640], 'shape_meta': {'obs': {'table_cam': {'shape': [3, 480, 640], 'type': 'rgb'}, 'left_arm_pose': {'shape': [9], 'type': 'low_dim'}, 'right_arm_pose': {'shape': [9], 'type': 'low_dim'}}, 'action': {'shape': [18]}}, 'task': {'name': 'haptic_image_teacher_aware', 'task_name': 'bottle_pick', 'dataset_path': '/home/ali/shared_volume/punyo_style/rdda_less/_replay_buffer.zarr', 'dataset_type': 'ph', 'abs_action': True, 'shape_meta': {'obs': {'table_cam': {'shape': [3, 480, 640], 'type': 'rgb'}, 'left_arm_pose': {'shape': [9], 'type': 'low_dim'}, 'right_arm_pose': {'shape': [9], 'type': 'low_dim'}}, 'action': {'shape': [18]}}, 'dataset': {'_target_': 'diffusion_policy.dataset.haptics_dataset.AvatarHapticsImageDataset', 'dataset_path': '/home/ali/shared_volume/punyo_style/rdda_less/_replay_buffer.zarr', 'shape_meta': {'obs': {'table_cam': {'shape': [3, 480, 640], 'type': 'rgb'}, 'left_arm_pose': {'shape': [9], 'type': 'low_dim'}, 'right_arm_pose': {'shape': [9], 'type': 'low_dim'}}, 'action': {'shape': [18]}}, 'horizon': 16, 'n_obs_steps': 2, 'pad_after': 7, 'pad_before': 1, 'seed': 42, 'val_ratio': 0.02}}, 'policy': {'_target_': 'diffusion_policy.policy.diffusion_unet_image_policy.DiffusionUnetImagePolicy', 'shape_meta': {'obs': {'table_cam': {'shape': [3, 480, 640], 'type': 'rgb'}, 'left_arm_pose': {'shape': [9], 'type': 'low_dim'}, 'right_arm_pose': {'shape': [9], 'type': 'low_dim'}}, 'action': {'shape': [18]}}, 'noise_scheduler': {'_target_': 'diffusers.schedulers.scheduling_ddim.DDIMScheduler', 'num_train_timesteps': 100, 'beta_start': 0.0001, 'beta_end': 0.02, 'beta_schedule': 'squaredcos_cap_v2', 'clip_sample': True, 'set_alpha_to_one': True, 'steps_offset': 0, 'prediction_type': 'epsilon'}, 'obs_encoder': {'_target_': 'diffusion_policy.model.vision.multi_image_obs_encoder.MultiImageObsEncoder', 'shape_meta': {'obs': {'table_cam': {'shape': [3, 480, 640], 'type': 'rgb'}, 'left_arm_pose': {'shape': [9], 'type': 'low_dim'}, 'right_arm_pose': {'shape': [9], 'type': 'low_dim'}}, 'action': {'shape': [18]}}, 'rgb_model': {'_target_': 'diffusion_policy.model.vision.model_getter.get_resnet', 'name': 'resnet18', 'weights': 'IMAGENET1K_V1'}, 'resize_shape': [240, 320], 'crop_shape': [216, 288], 'random_crop': True, 'use_group_norm': True, 'share_rgb_model': False, 'imagenet_norm': True}, 'horizon': 16, 'n_action_steps': 8, 'n_obs_steps': 2, 'num_inference_steps': 100, 'obs_as_global_cond': True, 'diffusion_step_embed_dim': 128, 'down_dims': [512, 1024, 2048], 'kernel_size': 5, 'n_groups': 8, 'cond_predict_scale': True}, 'ema': {'_target_': 'diffusion_policy.model.diffusion.ema_model.EMAModel', 'update_after_step': 0, 'inv_gamma': 1.0, 'power': 0.75, 'min_value': 0.0, 'max_value': 0.9999}, 'dataloader': {'batch_size': 176, 'num_workers': 14, 'shuffle': False, 'pin_memory': False, 'persistent_workers': True}, 'val_dataloader': {'batch_size': 112, 'num_workers': 14, 'shuffle': False, 'pin_memory': False, 'persistent_workers': True}, 'optimizer': {'_target_': 'torch.optim.AdamW', 'lr': 0.0001, 'betas': [0.95, 0.999], 'eps': 1e-08, 'weight_decay': 1e-06}, 'training': {'device': 'cuda:0', 'seed': 42, 'debug': False, 'resume': True, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 500, 'num_epochs': 4000, 'gradient_accumulate_every': 1, 'use_ema': True, 'freeze_encoder': False, 'rollout_every': 5, 'checkpoint_every': 50, 'val_every': 1, 'sample_every': 1, 'max_train_steps': None, 'max_val_steps': None, 'tqdm_interval_sec': 1.0}, 'logging': {'project': 'diffusion_policy_debug', 'resume': True, 'mode': 'online', 'name': '2024.10.08-17.54.41_table_cam_only_train_diffusion_unet_hybrid_haptic_image_teacher_aware', 'tags': ['table_cam_only_train_diffusion_unet_hybrid', 'haptic_image_teacher_aware', 'diffusion_ddim'], 'id': None, 'group': None}, 'checkpoint': {'topk': {'monitor_key': 'train_loss', 'mode': 'min', 'k': 5, 'format_str': 'epoch={epoch:04d}-train_loss={train_loss:.3f}.ckpt'}, 'save_last_ckpt': True, 'save_last_snapshot': False}, 'multi_run': {'run_dir': 'data/outputs/2024.10.08/17.54.41_table_cam_only_train_diffusion_unet_hybrid_haptic_image_teacher_aware', 'wandb_name_base': '2024.10.08-17.54.41_table_cam_only_train_diffusion_unet_hybrid_haptic_image_teacher_aware'}}
[INFO] [1728594145.905334]: Policy evaluated
[INFO] [1728594145.906433]: Model Loaded!
Warming up policy inference
